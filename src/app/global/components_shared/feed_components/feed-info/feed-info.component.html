<form [formGroup]="newFeedForm" class="full-width mb-4" #formDirective="ngForm">
    <mat-form-field class="full-width" appearance="fill">
        <mat-label>Feed Title</mat-label>
        <input matInput formControlName="feed_title" />
    </mat-form-field>

    <mat-form-field class="full-width" appearance="fill">
        <mat-label>Description</mat-label>
        <input matInput formControlName="description" />
    </mat-form-field>

    <mat-form-field class="full-width" appearance="fill" *ngIf="editing; else default">
        <mat-label>Feed Type</mat-label>
        <mat-select formControlName="feed_type" [(ngModel)]="fetched_feed.feedType.feedTypeId">
            <mat-option selected [value]="fetched_feed.feedType.feedTypeId">
                {{ fetched_feed.feedType.name }} -
                <small>{{ fetched_feed.feedType.description }}</small>
            </mat-option>
        </mat-select>
    </mat-form-field>

    <ng-template #default>
        <mat-form-field class="full-width" appearance="fill">
            <mat-label>Feed Type</mat-label>
            <mat-select formControlName="feed_type">
                <mat-option *ngFor="let f of feed_types" [value]="f.feedTypeId">
                    {{ f.name }} - <small>{{ f.description }}</small>
                </mat-option>
            </mat-select>
        </mat-form-field>
    </ng-template>

    <ng-container *ngIf="hasLoadedDealers">
        <app-dealer-autocomplete
            *ngIf="!isCurrentUserDealer && !editing; else dealerInput"
            (dealer_selected)="dealerSelected($event)"
            [initial_value]="selectedDealer"
            [active_only]="true">
        </app-dealer-autocomplete>

        <ng-template #dealerInput>
            <mat-form-field class="full-width" appearance="fill">
                <mat-label>Dealer</mat-label>
                <input matInput [value]="selectedDealer[0]?.value" disabled />
            </mat-form-field>
        </ng-template>
    </ng-container>

    <button
        *ngIf="!editing; else editingBtn"
        mat-button
        mat-raised-button
        matStepperNext
        class="theme-btn"
        [disabled]="!newFeedForm.valid"
        (click)="structureFeedInfo()">
        <span class="button-label">Next</span>
        <span class="fas fa-long-arrow-alt-right ml-2"></span>
    </button>

    <ng-template #editingBtn>
        <button
            mat-button
            mat-raised-button
            matStepperNext
            class="theme-btn"
            [disabled]="!newFeedForm.controls.feed_title.valid"
            (click)="structureFeedInfo()">
            <span class="button-label">Next</span>
            <span class="fas fa-long-arrow-alt-right ml-2"></span>
        </button>
    </ng-template>
</form>
